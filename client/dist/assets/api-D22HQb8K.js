const h="";console.warn("NEXT_PUBLIC_BACKEND_BASE not set");class y extends Error{constructor(e,n,o){super(e),this.status=n,this.details=o,this.name="ApiError"}}async function c(s,e={}){const n=`${h}${s.startsWith("/")?"":"/"}${s}`,{method:o="GET",body:i,signal:u}=e,d={"Content-Type":"application/json"};try{const t=await fetch(n,{method:o,headers:d,body:i?JSON.stringify(i):void 0,credentials:"omit",signal:u});if(!t.ok){let r;try{r=await t.json()}catch{}throw new Error(`[API] ${o} ${s} failed: ${t.status} ${t.statusText}`+(r?` :: ${JSON.stringify(r)}`:""))}return(t.headers.get("content-type")||"").includes("application/json")?await t.json():await t.text()}catch(t){throw(t==null?void 0:t.name)==="AbortError"?new Error("[API] Request aborted"):new Error(`[API] Network/CORS error on ${o} ${s}: ${(t==null?void 0:t.message)||t}`)}}const l={health:()=>c("/health"),chat:s=>c("/chat",{method:"POST",body:s}),faq:s=>c(`/faq?subField=${encodeURIComponent(s)}`)};class g{constructor(){this.baseUrl=h,this.retryAttempts=3,this.retryDelay=1e3}async makeRequest(e,n={}){return c(e,n)}shouldRetry(e){return(e==null?void 0:e.name)==="NetworkError"||(e==null?void 0:e.name)==="TimeoutError"}delay(e){return new Promise(n=>setTimeout(n,e))}async checkHealth(){return l.health()}async getSubjects(){return[]}async sendChatMessage(e){const n={userQuestion:e.message,major:e.majorCategory,subField:e.subCategory,conversationId:e.sessionId,suggestCount:e.suggestCount??3,followupMode:e.followupMode??"multi"},o=await l.chat(n);return{id:`ai-${Date.now()}`,content:o.aiResponse,timestamp:new Date().toISOString(),sessionId:o.conversationId,processingTime:0,suggestions:o.suggestions}}async sendFeedback(e){return console.log(`Feedback received for message ${e.messageId}: ${e.feedback}`),{success:!0,message:"Feedback recorded"}}async testConnection(){try{return await this.checkHealth(),!0}catch{return!1}}}const m=new g;async function w(){throw new Error("백엔드 주소 미설정: .env.local의 NEXT_PUBLIC_BACKEND_BASE를 확인하세요.")}function E(s){const{q:e,major:n,subField:o,conversationId:i,onStart:u,onDelta:d,onDone:t,onError:a,signal:r}=s;return a==null||a("백엔드 주소 미설정: .env.local의 NEXT_PUBLIC_BACKEND_BASE를 확인하세요."),()=>{}}async function f(s){throw new Error("BACKEND_BASE_NOT_SET")}export{y as A,m as a,w as e,f,E as s};
