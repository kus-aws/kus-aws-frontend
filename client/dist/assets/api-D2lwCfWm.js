import{j as l,c as f,b as d,S as g}from"./index-DNUojM5K.js";import{r as h}from"./vendor-CwHBbTcV.js";const p=d("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),v=h.forwardRef(({className:e,variant:t,size:s,asChild:n=!1,...r},c)=>{const u=n?g:"button";return l.jsx(u,{className:f(p({variant:t,size:s,className:e})),ref:c,...r})});v.displayName="Button";const o="https://2kdtuncj36tas5twwm7dsgpz5y0bkfkw.lambda-url.us-east-1.on.aws".replace("/$/","");class a extends Error{constructor(t,s,n){super(t),this.status=s,this.details=n,this.name="ApiError"}}function i(){if(!o)throw new Error("백엔드 주소 미설정: .env(또는 Vercel env)의 VITE_BACKEND_BASE를 확인하세요.")}function m(e){return Array.isArray(e)?e.filter(t=>typeof t=="string"&&t.trim()).slice(0,5):[]}async function j(){{i();const e=await fetch(`${o}/health`,{credentials:"omit"});try{return await e.json()}catch{return"ok"}}}function w(e){return e&&typeof e.aiResponse=="string"&&typeof e.conversationId=="string"}function y(e){return e&&Array.isArray(e.suggestions)}async function k(e){if(!e.userQuestion?.trim())throw new a("질문을 입력해주세요.");if(e.userQuestion.length>1e3)throw new a("질문은 1000자 이내로 입력해주세요.");if(!e.major?.trim()||!e.subField?.trim())throw new a("전공과 세부 분야를 선택해주세요.");{i();const t=await fetch(`${o}/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,followupMode:"never",suggestCount:0}),credentials:"omit"});if(!t.ok){console.error(`[chat] HTTP ${t.status} ${t.statusText}`);const n=await t.text().catch(()=>"No error text");console.error("[chat] Error response:",n);let r="서버 오류가 발생했습니다.";return t.status===429?r="요청이 너무 많습니다. 잠시 후 다시 시도해주세요.":t.status===502?(r="백엔드 서버에 일시적인 문제가 있습니다. 잠시 후 다시 시도해주세요.",console.error("[chat] 502 Bad Gateway - 백엔드 서버 문제 발생"),console.error("[chat] 백엔드 개발자에게 다음 정보를 전달하세요:"),console.error("[chat] - 오류: 502 Bad Gateway"),console.error("[chat] - 엔드포인트: /chat"),console.error("[chat] - 응답:",n),console.error("[chat] - 시간:",new Date().toISOString())):t.status===500?r="서버에 일시적인 문제가 있습니다. 잠시 후 다시 시도해주세요.":t.status===503?r="서비스가 일시적으로 사용불가합니다. 잠시 후 다시 시도해주세요.":t.status===400?r="잘못된 요청입니다. 입력 내용을 확인해주세요.":t.status>=500&&(r="서버 내부 오류가 발생했습니다."),{aiResponse:`죄송합니다. ${r} (${t.status})`,conversationId:e.conversationId??"unknown",suggestions:[]}}const s=await t.json().catch(()=>null);return w(s)?(s.suggestions=[],s):(console.warn("[chat] invalid shape:",s),{aiResponse:"죄송합니다. 일시적인 오류가 발생했습니다.",conversationId:e.conversationId??"unknown",suggestions:[]})}}async function S(e){{i();const t=await fetch(`${o}/suggestions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),credentials:"omit"});if(!t.ok)return console.warn("[suggestions] Backend call failed:",t.status),[];const s=await t.json().catch(()=>({suggestions:[]}));return y(s)?m(s.suggestions):(console.warn("[suggestions] invalid response shape:",s),[])}}export{v as B,k as c,S as f,j as h};
